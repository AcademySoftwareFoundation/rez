name: wheel
on:
  push:

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  launchers:
    name: launcher
    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v4

    - uses: ilammy/msvc-dev-cmd@v1
      with:
        arch: amd64

    - name: Build
      shell: bash
      run: |
        set -ex
        ls -la launcher
        git clone https://github.com/pypa/distlib.git

        cp distlib/PC/launcher.c launcher/

        cd launcher
        patch -Np1 -i remote-appended.patch --binary

        mkdir build
        cd build

        cmake .. -GNinja -DCMAKE_BUILD_TYPE=Release
        VERBOSE=1 cmake --build .

        ls -la
